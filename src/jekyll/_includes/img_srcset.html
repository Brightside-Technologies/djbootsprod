{% capture basename %} {{include.basename}} {% endcapture %}
{% assign stripBasename = {{basename | strip}} %}
{% assign responsive_images = site.static_files | where: "responsive", true %}
{% assign srcSetUrls = "" | split: ',' %}
{% assign srcSetItem = "" %}
{% assign default = "" %}
{% capture srcset %}
    {% for img in responsive_images %}
        {% if img.path contains stripBasename %}

            {% if img.path contains '@1x' %}
                {% assign srcSetItem = {{img.path | append: ' 300w'}} %} 
            {% elsif img.path contains '@2x' %}
                {% assign srcSetItem = {{img.path | append: ' 600w'}} %}
                {% assign default = {{srcSetItem | replace: " 600w", ""}} %}
            {% elsif img.path contains '@3x' %}
                {% assign srcSetItem = {{img.path | append: ' 900w'}} %}
            {% else %}
                {% assign srcSetItem = {{img.path | append: ' 600w'}} %}
            {% endif %}

            {% assign imageSetUrls = srcSetUrls | push: srcSetItem %}

        {% endif %}
    {% endfor %}
    {{srcSetUrls | join: ', '}}
{% endcapture %}

<img src="{{ default | absolute_url }}" alt="{{ content.alt }}" srcset="{{ srcset | strip }}" sizes="(max-width: 320px) 300px, (max-width: 640px): 600px, 1000px">
